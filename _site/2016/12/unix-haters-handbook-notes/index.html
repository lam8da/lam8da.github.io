<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="author" content="lambda" />
    <title>Unix痛恨者手册读书笔记 | lambda</title>
    <link rel="shortcut icon" href="/favicon.ico">
    <link href="http://localhost:4000/feed/" rel="alternate" title="lambda" type="application/atom+xml" />
    <link rel="stylesheet" href="/media/css/style.css">
    <link rel="stylesheet" href="/media/css/highlight.css">
    <link rel="stylesheet" href="/media/css/highlighter-rouge.css">
    <script type="text/javascript" src="//code.jquery.com/jquery-2.1.1.min.js"></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        "HTML-CSS": { scale: 80 },
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          displayMath: [ ["$$","$$"], ["\\[", "\\]"] ],
          processEscapes: true
        }
      });
    </script>
    <script type="text/javascript" async src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </head>
  <body>
    <div id="container">
      <div id="main" role="main">
        <header>
        <h1>Unix痛恨者手册读书笔记</h1>
        </header>
        <nav>
        <span><a title="home page" class="" href="http://localhost:4000/">首页</a></span>
        <span><a title="categories" class="" href="http://localhost:4000/categories/">分类</a></span>
        <span><a title="tags" class="" href="http://localhost:4000/tags/">标签</a></span>
        <span><a title="links" class="" href="http://localhost:4000/links/">链接</a></span>
        <span><a title="about" class="" href="http://localhost:4000/about/">关于</a></span>
        <span><a title="subscribe by RSS" class="" href="http://localhost:4000/feed/">订阅</a></span>
        </nav>
        <article class="content">
        <section class="post">

<p>一些经验总结以及好玩的段子摘录：</p>

<ul>
  <li>请千万别让人用“安全”命令去替换标准命令。
    <ol>
      <li>许多shell程序会对多嘴的<code class="language-sh highlighter-rouge">rm</code>感到惊讶，而且也不会想到删除了的文件仍然占有磁盘空间。</li>
      <li>并不是所有删除操作都是安全的，有户会因此产生一切都能恢复的错觉。</li>
      <li>那些不标准的命令对系统管理员来说尤其可恨。如果你想有个有确认功能的“<code class="language-sh highlighter-rouge">rm</code>”，用下面的命令: <code class="language-sh highlighter-rouge"><span class="gp">% </span><span class="nb">alias </span>del rm -i</code></li>
    </ol>

    <p>千万别替换<code class="language-sh highlighter-rouge">rm</code>!</p>
  </li>
  <li>
    <p>有人整理了一些UNIX最为可笑的错误信息，把他发布在Usenet上。他们使用的是C shell.</p>

    <div class="language-sh highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre></td><td class="code"><pre><span class="gp">% </span>rm meese-ethics 
rm: messe-ethics nonexistent
  
<span class="gp">% </span>ar m God 
ar: God does not exist
  
<span class="gp">% </span><span class="s2">"How would you rate Dan Quayle's incompetence? 
Unmatched "</span>.
  
<span class="gp">% </span>^How did the sex change^ operation go? 
Modifier failed.
  
<span class="gp">% </span>If I had a <span class="o">(</span> <span class="k">for </span>every <span class="nv">$ </span>the Congress spent, what would I have? 
Too many <span class="o">(</span><span class="s1">'s
  
% make love 
Make: Don'</span>t know how to make love. Stop.
  
<span class="gp">% </span>sleep with me 
bad character
  
<span class="gp">% </span>got a light? 
No match
  
<span class="gp">% </span>man: why did you get a divorce? 
man: Too many arguments.
  
<span class="gp">% </span>^What is saccharine? 
Bad substitute.
  
<span class="gp">% </span>%blow 
%blow: No such job.
</pre></td></tr></tbody></table>
</div>
    </div>

    <p>下面的这些幽默作品来自Bourne Shell:</p>

    <div class="language-sh highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9</pre></td><td class="code"><pre><span class="gp">$ </span><span class="nv">PATH</span><span class="o">=</span>pretending! /usr/ucb/which sense 
no sense <span class="k">in </span>pretending
  
<span class="gp">$ </span>drink &lt;bottle; opener 
bottle: cannot open 
opener: not found
  
<span class="gp">$ </span>mkdir matter; cat &gt;matter 
matter: cannot create
</pre></td></tr></tbody></table>
</div>
    </div>
  </li>
  <li>Don Libes和Sandy Ressler在《UNIX生活》(Life with UNIX)中对UNIX哲学作了很好的总结：
    <ul>
      <li>小即是美</li>
      <li>用10%的工作解决90%的任务</li>
      <li>如果必须作出选择，选择最简单的那个。</li>
    </ul>
  </li>
  <li>根据UNIX程序和工具的实际表现来看，对UNIX哲学更为精确的总结应该是:
    <ul>
      <li>小的程序比正确的程序更好</li>
      <li>粗制滥造是可以接受的</li>
      <li>如果必须作出选择，选择责任最小的那个。</li>
    </ul>
  </li>
  <li>大多数操作系统上的“kill”仅仅用来杀死进程。但UNIX的设计更为通用：“kill”被用来向进程发送一个信号，这体现了UNIX的一个设计原则：尽量使操作通用，给予用户强大力量(power)</li>
  <li>这又体现了一个UNIX设计原则：对于给用户的反馈，能少说绝不多说，能晚说绝不早说。以免过多信息所可能导致的用户脑损伤。</li>
  <li>有人开玩笑说：“如果你觉得需要阅读关于内核函数的文档，那么很可能你本来就不配使用这些函数。”</li>
  <li>
    <p>所有读过UNIX代码的人都被下面的一行粗暴注释惊呆过：</p>

    <div class="language-c++ highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="cm">/* you are not expected to understand this */</span> <span class="err">（</span><span class="cm">/* 没指望你能明白 */</span><span class="err">）</span>
</pre></td></tr></tbody></table>
</div>
    </div>
  </li>
  <li>如何知道运行正确：没有消息就是好消息</li>
  <li>GPL的好处在于你不必为自己的工作负责，也不必对用户负责</li>
  <li>“有些操作系统从没有被好好计划，以至于只好用反刍的噪音来命名它的命令（awk, grep, fsck, norff），我想到这个就反胃。” —— 无名氏</li>
  <li>这七种针对shell命令行的转换方式是：
    <ul>
      <li>别名：<code class="language-sh highlighter-rouge"><span class="nb">alias</span>, <span class="nb">unalias</span></code></li>
      <li>命令输出替代：<code class="language-sh highlighter-rouge"><span class="sb">`</span></code></li>
      <li>文件名替代：<code class="language-sh highlighter-rouge"><span class="k">*</span>, ?, <span class="o">[]</span></code></li>
      <li>历史替代：<code class="language-sh highlighter-rouge">!, ^</code></li>
      <li>变量替代：<code class="language-sh highlighter-rouge"><span class="nv">$,</span> <span class="nb">set</span>, <span class="nb">unset</span></code></li>
      <li>进程替代：<code class="language-sh highlighter-rouge">%</code></li>
      <li>引用：<code class="language-sh highlighter-rouge"><span class="s1">', "</span></code></li>
    </ul>

    <p>这一“设计”的结果是，问号(?)永远被shell当成单字符匹配符，它永远无法被作为命令行参数传给用户程序，所以别想使用问号来作为帮助选项。</p>
  </li>
  <li><code class="language-sh highlighter-rouge"><span class="s2">"</span><span class="k">${</span><span class="nv">1</span><span class="p">+</span><span class="s2">"</span><span class="nv">$@</span><span class="s2">"</span><span class="k">}</span><span class="s2">"</span></code>究竟是什么意思：这是<code class="language-sh highlighter-rouge">/bin/sh</code>里用来完整复制命令行参数的一种方法。它的意思是：如果有至少一个参数(<code class="language-sh highlighter-rouge"><span class="k">${</span><span class="nv">1</span><span class="p">+</span></code>)，那么用所有参数(<code class="language-sh highlighter-rouge"><span class="s2">"</span><span class="nv">$@</span><span class="s2">"</span></code>)来替代以保留所有的空白字符。如果我们只使用<code class="language-sh highlighter-rouge"><span class="s2">"</span><span class="nv">$@</span><span class="s2">"</span></code>，那么在没有参数的情形下会得到<code class="language-sh highlighter-rouge"><span class="s2">""</span></code>而不是我们想要的空参数。</li>
  <li>那么，为什么不使用<code class="language-sh highlighter-rouge"><span class="s2">"</span><span class="nv">$*</span><span class="s2">"</span></code>呢？sh(1)的man手册是这样说的：双引号之间的参数和命令会被替换，shell会对结果加上引用，以避免解析空格或生成文件名。如果<code class="language-sh highlighter-rouge"><span class="nv">$*</span></code>出现在双引号之中，各个参数之间的空格会被加上引用(<code class="language-sh highlighter-rouge"><span class="s2">"</span><span class="nv">$1</span><span class="s2"> </span><span class="nv">$2</span><span class="s2"> ..."</span></code>)，而如果<code class="language-sh highlighter-rouge"><span class="nv">$@</span></code>出现在双引号之中，各个参数之间的空格不会被加上引用(<code class="language-sh highlighter-rouge"><span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span> <span class="s2">"</span><span class="nv">$2</span><span class="s2">"</span> ...</code>)。</li>
  <li>如果我写着不容易，那么你理解起来就不应该容易。 —— 一个Unix程序员</li>
  <li>Unix程序员总是打着“这会破坏已有代码”的幌子，不愿意修正bug。可这里面还有内幕，修正bug不但会破坏已有代码，还必须修改简单完美的Unix接口，而这正是Unix教众们的命根子。至于这个接口是否工作，这并不重要。Unix教众们不去提出更好的接口，也不去修正bug，而是齐声高唱“Unix接口好简洁，好简洁。Unix接口就是美，就是美！Unix无罪！Unix有理！”。不幸的是，绕过bug是个很恶劣的行为，它使得错误成为了操作系统规范的一部分。你越是等，就越难以修正，因为越来越多的程序会尽力绕过bug，以至于没有了bug反而活不了了。同理，修改操作系统接口带来的影响更大，因为更多的程序必须根据这个正确的新接口进行修改。(这解释了为什么ls有那么多的选项来完成几乎一样的工作)。</li>
  <li>如果你把一只青蛙仍到开水里，它会马上跳出来。它知道开水很烫。可是，如果你把青蛙放到冷水里，再慢慢地加热，青蛙感觉不到什么，直到最后被烫死。Unix接口已经开锅了。以前，输入/输出的全部接口只包括open, close, read和write。网络支持给Unix添了一大把柴禾。现在，至少有五种方法向一个文件句柄输入数据：write, writev, send, sendto和sendmsg。每个都在内核中有不同的实现，这意味着有五倍的可能出现bug，有五种不同的性能结果需要考虑。读文件也一样(read, recv, recvfrom和recvmsg)。等死吧，青蛙们。</li>
  <li>问：”C”和”C++”的名字是怎么来的？答：这是他们的成绩 —— Jerry Leichter。再没有比C++更能体现Unix“绝不给用户好脸”的哲学思想的了。</li>
  <li>面向对象的汇编语言（注：指C++）</li>
</ul>

</section>
<section class="meta">
<span class="author">
  <a href="http://lam8da.github.io">lambda</a>
</span>
<span class="time">
  /
  <time datetime="2016-12-31">2016-12-31</time>
</span>
<br />
<span class="license">
  Published under <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">(CC) BY-NC-SA</a>
</span>

<span class="categories">
  in categories
  
  <a href="http://localhost:4000/categories/#程序&设计" title="程序&设计">程序&设计</a>&nbsp;
  
</span>


<span class="tags">
  tagged with 
  
  <a href="http://localhost:4000/tags/#读书笔记" title="读书笔记">读书笔记</a>&nbsp;
  
  <a href="http://localhost:4000/tags/#Unix" title="Unix">Unix</a>&nbsp;
  
  <a href="http://localhost:4000/tags/#Linux" title="Linux">Linux</a>&nbsp;
  
  <a href="http://localhost:4000/tags/#Work in Progress" title="Work in Progress">Work in Progress</a>&nbsp;
  
</span>

</section>
<section class="comment">
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'lambda'; // required: replace example with your forum shortname
    var disqus_url = 'http://localhost:4000/2016/12/unix-haters-handbook-notes/';
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>


<script type="text/javascript">
$(function() {
    $(document).keydown(
      function(e) {
        if (e.target.nodeName.toUpperCase() != 'BODY') return;
        var url = false;
        if (e.which == 37 || e.which == 74) {  // Left arrow and J
          
            url = 'http://localhost:4000/2016/12/lawn-mover-repair/';
          
        } else if (e.which == 39 || e.which == 75) {  // Right arrow and K
          
            url = 'http://localhost:4000/2017/03/remembrance-of-things-past/';
          
        }
        if (url) {
          window.location = url;
        }
      });
})
</script>

        </article>
      </div>
    </div>
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-1988641-2']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script');
        ga.type = 'text/javascript';
        ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </body>
</html>
